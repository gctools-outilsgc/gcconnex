trigger:  # don't trigger outside PRs
- none

pr:  # Trigger the pipeline only for PRs targeting master branch
- master


variables:
  imageRepository: 'collab'
  imageTag: 'PR-$(System.PullRequest.PullRequestNumber)-$(Build.SourceVersion)'

pool:
  vmImage: 'ubuntu-latest'


steps:
- task: Docker@2
  displayName: Build and Push Container image to ACR
  inputs:
    azureSubscription: 'Visual Studio Enterprise (a7b5a8d0-c8df-4fb1-8f6b-9080e188ef57)'
    command: 'buildAndPush'
    containerRegistry: $(acrName)
    repository: $(imageRepository)
    tags: $(imageTag)
  env:
    acrName: $(acrName)
